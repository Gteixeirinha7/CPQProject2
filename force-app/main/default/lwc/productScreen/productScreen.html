<!-- sldsValidatorIgnore -->
<template>
	<template if:true={isOpenConfigKit}>
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-01"
			aria-modal="true"
			aria-describedby="modal-content-id-1"
			class="slds-modal slds-fade-in-open container__kit-configure"
		>
			<lightning-spinner if:true={isLoadingModal} alternative-text="Loading..." size="medium"></lightning-spinner>

			<div class="slds-modal__container" style="width: 75% !important; max-width: 75% !important;">
				<header class="slds-modal__header">
					<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleCloseConfigKit}>
						<lightning-icon
							icon-name="utility:close"
							alternative-text="close"
							variant="inverse"
							size="small">
						</lightning-icon>
						<span class="slds-assistive-text">Close</span>
					</button>

					<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Configurar Kit</h2>
				</header>

				<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1" style="height: 700px;">
					
					<lightning-layout multiple-rows horizontal-align="center">
						<lightning-layout-item class="slds-var-m-top_medium slds-var-p-horizontal_small" size="12" >
    						<lightning-progress-indicator current-step={currentGroupShowId}>
								<template for:each={currentProductConfig.groupAccessoryList} for:item="group" for:index="groupIndex">
    						    	<lightning-progress-step key={group.id} label={group.name} value={group.id}>
    						    	</lightning-progress-step>
								</template>
    						</lightning-progress-indicator>
						</lightning-layout-item>
						<lightning-layout-item class="slds-var-m-top_medium slds-var-p-horizontal_small" size="12"  style=" display: flex; justify-content: center;">
							<p><b>{currentGroupShowName}</b></p>
						</lightning-layout-item>
						<lightning-layout-item class="slds-var-m-top_medium slds-var-p-horizontal_small" size="12" >
							<lightning-layout multiple-rows horizontal-align="center" style="display: flex;align-items: center;">
								<template for:each={currentProductConfig.groupAccessoryList} for:item="group" for:index="groupIndex">
									<template if:true={group.isCurrentGroup}>
										
										<lightning-layout-item key={group.id} class="slds-var-p-around_x-small" size="1" medium-device-size="1" large-device-size="1" style="display: flex; justify-content: space-around;">
											<lightning-button-icon 
												if:false={group.isFirstGroup}
												data-id={group.id}
												data-index={groupIndex}
												icon-name="utility:arrow_left"  
												variant="border-filled" 
												onclick={onClickBackAccessoryGroup}>
											</lightning-button-icon>
										</lightning-layout-item>
										<lightning-layout-item key={group.id} class="slds-var-p-around_x-small" size="10" medium-device-size="10" large-device-size="10" style="display: flex; justify-content: space-around;">
											<lightning-layout multiple-rows horizontal-align="center">
												<template if:true={group.isShowGroup} >
													<template if:true={group.isListing}>
														<template for:each={group.comboList} for:item="combo">								
															<lightning-layout-item key={combo.id} class="slds-var-p-around_x-small" size="12" medium-device-size="4" large-device-size="4" >							
																	<c-product-component-acessory-combo
																	combo={combo}
																	onhandleproductdataconfig={handleAcessoryDataConfig}
																	onselectconfig={handlerSelectAccessory}
																	onshowcombo={handlerShowCombo}
																	isconfig={defaultTrue}>
																</c-product-component-acessory-combo>
															</lightning-layout-item>
														</template>
														<template for:each={group.accessoryList} for:item="accessory">	
															<template if:false={accessory.isCombo} >		
															<lightning-layout-item key={accessory.id} class="slds-var-p-around_x-small" size="12" medium-device-size="4" large-device-size="4" >							
																	<c-product-component-accessory
																	product={accessory}
																	onhandleproductdataconfig={handleAcessoryDataConfig}
																	onselectconfig={handlerSelectAccessory}
																	isconfig={defaultTrue}>
																</c-product-component-accessory>
															</lightning-layout-item>
															</template>
														</template>
													</template>
													<template if:false={group.isListing}>
														<div class="container__accessory-item">
															<p> <b>{group.nameCompleted}:</b> </p>
															<p if:true={group.isNA}> ESTE ACESSÓRIO NÃO SE APLICA A MONTAGEM </p>
															<p if:true={group.isIncluded}> Incluso </p>
														</div>
													</template>
												</template>
											</lightning-layout>
										</lightning-layout-item>
										
										<lightning-layout-item key={group.id} class="slds-var-p-around_x-small" size="1" medium-device-size="1" large-device-size="1" style="display: flex; justify-content: space-around;">
											<lightning-button-icon 
												if:false={group.isLastGroup}
												data-id={group.id}
												data-index={groupIndex}
												icon-name="utility:arrow_right"  
												variant="brand" 
												onclick={onClickNextAccessoryGroup}>
											</lightning-button-icon>
										</lightning-layout-item>
									</template>
								</template>
							</lightning-layout>
						</lightning-layout-item>
					</lightning-layout>
				</div>

				<footer class="slds-modal__footer">
					<button class="slds-button slds-button_neutral" onclick={handleCloseConfigKit} title="Cancel">Cancelar</button>
					<button class="slds-button slds-button_brand" onclick={handleSaveConfigKit} title="Salvar">Salvar</button>
				</footer>
			</div>
		</section>

		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>

	<template if:true={isOpenNewAccessoryModal}>
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-02"
			aria-modal="true"
			aria-describedby="modal-content-id-2"
			class="slds-modal slds-fade-in-open"
		>
			<lightning-spinner if:true={isLoadingModal} alternative-text="Loading..." size="medium"></lightning-spinner>

			<div class="slds-modal__container">
				<header class="slds-modal__header">
					<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={onClickCancelNewAccessory}>
						<lightning-icon
							icon-name="utility:close"
							alternative-text="close"
							variant="inverse"
							size="small">
						</lightning-icon>
						<span class="slds-assistive-text">Close</span>
					</button>

					<h2 class="slds-text-heading_medium slds-hyphenate">Novo acessório</h2>
				</header>

				<div class="slds-modal__content slds-p-around_medium">
					<lightning-layout multiple-rows horizontal-align="center">
						<lightning-input
							name="productCode"
							label="Pesquisar acessório..."
							value={productCode}
							type="search"
							field-level-help="Digite o nome ou código do acessório"
							is-loading={productCodeLoading}
							onchange={handleProductCode}
						>
						</lightning-input>
					</lightning-layout>

					<lightning-layout multiple-rows horizontal-align="space">
						<template for:each={excpProducts} for:item="products">

							<lightning-layout-item
								key={products.id}
								class="slds-var-p-around_x-small"
								size="12" medium-device-size="12" large-device-size="12"
							>									
								
								<c-product-component-accessory
									product={products}
									onhandleproductdata={handleNewAcessoryProductData}
									onclickselectexceptionaccessoryevent={clickSelectExceptionAccessoryEvent}
									onremoveexception={onClickRemoveExceptionAccessory}
								>
								</c-product-component-accessory>
							
							</lightning-layout-item>

						</template>
					</lightning-layout>
				</div>

				<footer class="slds-modal__footer">
					<button class="slds-button slds-button_neutral" title="Cancel" onclick={onClickCancelNewAccessory}>Cancelar</button>
					<button class="slds-button slds-button_brand" title="Salvar" onclick={onClickSaveNewAccessory}>Salvar</button>
				</footer>
			</div>
		</section>

		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>

	<template if:true={isOpenEditAccessoryModal}>
		<section
			role="dialog"
			tabindex="-1"
			aria-labelledby="modal-heading-02"
			aria-modal="true"
			aria-describedby="modal-content-id-2"
			class="slds-modal slds-fade-in-open"
		>
			<lightning-spinner if:true={isLoadingModal} alternative-text="Loading..." size="medium"></lightning-spinner>

			<div class="slds-modal__container">
				<header class="slds-modal__header">
					<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={onClickCancelNewAccessory}>
						<lightning-icon
							icon-name="utility:close"
							alternative-text="close"
							variant="inverse"
							size="small">
						</lightning-icon>
						<span class="slds-assistive-text">Close</span>
					</button>

					<h2 class="slds-text-heading_medium slds-hyphenate">Editar acessório</h2>
				</header>

				<div class="slds-modal__content slds-p-around_medium">
					<lightning-layout multiple-rows horizontal-align="space">
							<lightning-layout-item
								class="slds-var-p-around_x-small"
								size="12" medium-device-size="12" large-device-size="12"
							>								
								<c-product-component-accessory
									product={currentExceptionEdit}
									onhandleproductdata={handleAcessoryData}
									onclickselectexceptionaccessoryevent={clickSelectExceptionAccessoryEvent}
									onremoveexception={onClickRemoveExceptionAccessory}
								>
								</c-product-component-accessory>
							</lightning-layout-item>
					</lightning-layout>
				</div>

				<footer class="slds-modal__footer">
					<button class="slds-button slds-button_brand" title="Salvar" onclick={onClickCancelNewAccessory}>Fechar</button>
				</footer>
			</div>
		</section>

		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>

	<div class="main">
		<lightning-spinner if:true={isLoading} alternative-text="Loading..." size="medium"></lightning-spinner>
		<lightning-layout class="container__header" horizontal-align="spread">
			<lightning-layout-item size="12">
			<div class="slds-page-header slds-page-header_record-home">
			  <div class="slds-page-header__row">
			    <div class="slds-page-header__col-title">
			      <div class="slds-media">
			        <div class="slds-media__figure">
			          <lightning-icon icon-name="standard:quotes"></lightning-icon>
			        </div>
			        <div class="slds-media__body">
			          <div class="slds-page-header__name">
			            <div class="slds-page-header__name-title">
			              <h1>
			                <span>Configurador de Produtos</span>
			                <span class="slds-page-header__title slds-truncate">{baseObject.Name}</span>
			              </h1>
			            </div>
			          </div>
			        </div>
			      </div>
			    </div>
			    <div class="slds-page-header__col-actions">
			      <div class="slds-page-header__controls">
			        <div class="slds-page-header__control">
			          <lightning-button-group>
			            <lightning-button label="Inicio" onclick={handleNewStructure} data-component='Estrutura' icon-name="utility:home" ></lightning-button>
			            <lightning-button if:true={isShowResources} label="Buscar" icon-name="utility:search" variant="brand" onclick={handleSearchProductStructure} disabled={isShowProducts}></lightning-button>
			            <lightning-button if:true={showCarrinho}  label="Concluir" variant="brand" onclick={handleSaveProducts}></lightning-button>
			          </lightning-button-group>
			        </div>
			      </div>
			    </div>
			  </div>
			  <div class="slds-page-header__row slds-page-header__row_gutters">
			    <div class="slds-page-header__col-details"> 	
			      <ul class="slds-page-header__detail-row">
			        <li class="slds-page-header__detail-block">
			          <div class="slds-text-title slds-truncate">Conta</div>
			          <div class="slds-truncate">{baseObject.Account.Name}</div>
			        </li>
			        <li class="slds-page-header__detail-block">
			          <div class="slds-text-title slds-truncate">Catalogo de Preço</div>
			          <div class="slds-truncate">{baseObject.Pricebook2.Name}</div>
			        </li>
			        <li class="slds-page-header__detail-block">
			          <div class="slds-text-title slds-truncate">Moeda</div>
			          <div class="slds-truncate">{baseObject.CurrencyIsoCode}</div>
			        </li>
			        <li class="slds-page-header__detail-block">
			          <div class="slds-text-title slds-truncate">Vendedor</div>
			          <div class="slds-truncate">{baseObject.CreatedBy.Name}</div>
			        </li>
			      </ul>
			    </div>
			  </div>
			</div>
			</lightning-layout-item>
		</lightning-layout>


	<lightning-layout if:true={isShowStructures} multiple-rows horizontal-align="space">
		<lightning-layout-item class="slds-var-p-horizontal_x-small container__items" size="12">
			<div class="slds-vertical-tabs">
			  <div class="slds-vertical-tabs__nav">
			    <div onclick={showComponentTab} data-component='Estrutura' class={getClassEstrutura}>
			      <a class="slds-vertical-tabs__link">
			        <span class="slds-vertical-tabs__left-icon">
			          <lightning-icon icon-name="standard:asset_hierarchy"></lightning-icon>
			        </span>
			        <span class="slds-truncate">Montar Configuração</span>
			        <span class="slds-vertical-tabs__right-icon"></span>
			      </a>
			    </div>
			    <div onclick={showComponentTab} data-component='Pronta' class={getClassProduto}>
			      <a class="slds-vertical-tabs__link">
			        <span class="slds-vertical-tabs__left-icon">
			          <lightning-icon icon-name="standard:asset_audit"></lightning-icon>
			        </span>
			        <span class="slds-truncate" title="Cases">Configuração Pronta</span>
			        <span class="slds-vertical-tabs__right-icon"></span>
			      </a>
			    </div>
			    <div onclick={showComponentTab} data-component='Excecao' class={getClassExcecao}>
			      <a class="slds-vertical-tabs__link">
			        <span class="slds-vertical-tabs__left-icon">
			          <lightning-icon icon-name="standard:data_transforms"></lightning-icon>
			        </span>
			        <span class="slds-truncate" title="Cases">Configuração Exceção</span>
			        <span class="slds-vertical-tabs__right-icon"></span>
			      </a>
			    </div>
			    <div onclick={showComponentTab} data-component='SingleProduct' class={getClassSingleProduct}>
			      <a class="slds-vertical-tabs__link">
			        <span class="slds-vertical-tabs__left-icon">
			          <lightning-icon icon-name="standard:product"></lightning-icon>
			        </span>
			        <span class="slds-truncate" title="Cases">Produtos</span>
			        <span class="slds-vertical-tabs__right-icon"></span>
			      </a>
			    </div>
			    <div onclick={showComponentTab} data-component='Carrinho' class={getClassCarrinho}>
			      <a class="slds-vertical-tabs__link">
			        <span class="slds-vertical-tabs__left-icon">
			          <lightning-icon icon-name="standard:webcart"></lightning-icon>
			        </span>
			        <span class="slds-truncate" title="Cases">Carrinho</span>
			        <span class="slds-vertical-tabs__right-icon"></span>
			      </a>
			    </div>
			  </div>
			  	<template if:true={showEstrutura}>
					<lightning-layout multiple-rows horizontal-align="space" style="width: 100%;justify-content: flex-start;">
						<lightning-layout-item
							class="slds-var-m-vertical_xx-small slds-var-p-horizontal_x-small"
							size="12" style="text-align: center;font-size: 16px;font-weight: bold;"
						>
							<c-global-search-product-screen filter-list={filterList} onselectfilter={selectFilterComponent} onhandlefilter={handlefilterComponent}></c-global-search-product-screen>
						</lightning-layout-item>
						<template for:each={structures} for:item="structure">
							<lightning-layout-item key={structure.Id} style="justify-content: flex-start;" class="slds-var-p-around_xx-small container__cart-structure" size="2" medium-device-size="2" small-device-size="4">
								<c-structure-component 
									structure={structure}
									onhandlestructure={handleStructure}>
								</c-structure-component>
							</lightning-layout-item>
						</template>	
						<!-- <lightning-layout-item class="slds-var-p-around_xx-small container__cart-structure" size="2" medium-device-size="2" small-device-size="4">
							<c-structure-component 
								structure={structureException}
								onhandlestructure={handleStructure}>
							</c-structure-component>
						</lightning-layout-item> -->
					</lightning-layout>
				</template>
			  	<template if:true={showProduto}>
					<lightning-layout multiple-rows horizontal-align="space">
						<lightning-layout-item
							class="slds-var-m-vertical_xx-small slds-var-p-horizontal_x-small"
							size="12" style="text-align: center;font-size: 16px;font-weight: bold;"
						>
							<c-global-search-product-screen filter-list={filterListProducts} onselectfilter={selectFilterProductomponent} onhandlefilter={handlefilterProductComponent}></c-global-search-product-screen>
						</lightning-layout-item>
						<template for:each={newStructures} for:item="product">						
							<lightning-layout-item
								key={product.id}
								class="slds-var-p-around_x-small"
								size="8"
							>						
								<c-product-component
									product={product}
									enable-create-accessory
									onhandleproductdata={handleProductData}
									onhandleconfigkit={handleConfigureKit}
									onhandleclearconfigkit={handleClearKitConfiguration}
									onhandleselectproduct={handleSelectProduct}
									onhandleremoveproduct={handleRemoveProduct}
									onhandlechangeacessory={handleChangeAcessory}
									onhandleremoveexception={handleremoveexception}
									onhandleeditexception={handleeditexception}
									onaddexceptionaccessory={onClickAddExceptionAccessoryEvent}
								>
								</c-product-component>
							
							</lightning-layout-item>
						
						</template>
					
						<lightning-layout-item class="container__button-more" size="12">
							<lightning-button-icon
								icon-name="utility:down"
								size="medium"
								variant="brand"
								alternative-text="View More"
								onclick={onClickSeeMoreProduct}
							>
							</lightning-button-icon>
						</lightning-layout-item>
					</lightning-layout>
				</template>
			  	<template if:true={showExcecao}>
					<lightning-layout multiple-rows horizontal-align="space">
						<lightning-layout-item
							class="slds-var-m-vertical_xx-small slds-var-p-horizontal_x-small"
							size="12" style="text-align: center;font-size: 16px;font-weight: bold;"
						>
							<c-global-search-product-screen filter-list={filterListProducts} onselectfilter={selectFilterProductomponent} onhandlefilter={handlefilterProductComponent}></c-global-search-product-screen>
						</lightning-layout-item>
						<template for:each={products} for:item="product">						
							<lightning-layout-item
								key={product.id}
								class="slds-var-p-around_x-small"
								size="8"
							>						
								<c-product-component
									product={product}
									enable-create-accessory
									onhandleproductdata={handleProductData}
									onhandleconfigkit={handleConfigureKit}
									onhandleclearconfigkit={handleClearKitConfiguration}
									onhandleselectproduct={handleSelectProduct}
									onhandleremoveproduct={handleRemoveProduct}
									onhandlechangeacessory={handleChangeAcessory}
									onhandleremoveexception={handleremoveexception}
									onhandleeditexception={handleeditexception}
									onaddexceptionaccessory={onClickAddExceptionAccessoryEvent}
								>
								</c-product-component>
							
							</lightning-layout-item>
						
						</template>
					
						<lightning-layout-item class="container__button-more" size="12">
							<lightning-button-icon
								icon-name="utility:down"
								size="medium"
								variant="brand"
								alternative-text="View More"
								onclick={onClickSeeMoreExceptionProduct}
							>
							</lightning-button-icon>
						</lightning-layout-item>
					</lightning-layout>
				</template>
			  	<template if:true={showSingleProduct}>
					<lightning-layout multiple-rows horizontal-align="space">
						<lightning-layout-item
							class="slds-var-m-vertical_xx-small slds-var-p-horizontal_x-small"
							size="12" style="text-align: center;font-size: 16px;font-weight: bold;"
						>
							<c-global-search-product-screen filter-list={filterListProducts} onselectfilter={selectFilterProductomponent} onhandlefilter={handlefilterProductComponent}></c-global-search-product-screen>
						</lightning-layout-item>
						<template for:each={singleProduts} for:item="product">		
							<lightning-layout-item
								key={product.id}
								class="slds-var-p-around_x-small"
								size="8"
							>						
								<c-product-component
									product={product}
									onhandleproductdata={handleProductData}
									onhandleconfigkit={handleConfigureKit}
									onhandleclearconfigkit={handleClearKitConfiguration}
									onhandleselectproduct={handleSelectProduct}
									onhandleremoveproduct={handleRemoveProduct}
									onhandlechangeacessory={handleChangeAcessory}
									onhandleremoveexception={handleremoveexception}
									onhandleeditexception={handleeditexception}
									onaddexceptionaccessory={onClickAddExceptionAccessoryEvent}
								>
								</c-product-component>
							
							</lightning-layout-item>
						</template>
					
						<lightning-layout-item class="container__button-more" size="12">
							<lightning-button-icon
								icon-name="utility:down"
								size="medium"
								variant="brand"
								alternative-text="View More"
								onclick={onClickSeeMoreExceptionProduct}
							>
							</lightning-button-icon>
						</lightning-layout-item>
					</lightning-layout>
				</template>
				<template if:true={showCarrinho}>
					<lightning-layout multiple-rows horizontal-align="space">
						<template for:each={checkoutProducts} for:item="product">
							<lightning-layout-item key={product.id} class="slds-var-m-vertical_medium container__product-checkout" size="12" style="max-width: 85%;">
								<c-product-component
									product={product}
									enable-create-accessory
									onhandleproductdata={handleProductData}
									onhandleconfigkit={handleConfigureKit}
									onhandleclearconfigkit={handleClearKitConfiguration}
									onhandleselectproduct={handleSelectProduct}
									onhandleremoveproduct={handleRemoveProduct}
									onhandlechangeacessory={handleChangeAcessory}
									onhandleremovecheckoutacessory={handleRemoveCheckoutAcessory}
									onhandleremoveexception={handleremoveexception}
									onhandleeditexception={handleeditexception}
									onaddexceptionaccessory={onClickAddExceptionAccessoryEvent}
								>
								</c-product-component>
							</lightning-layout-item>
						</template>
					</lightning-layout>
				</template>
			</div>
		</lightning-layout-item>
	</lightning-layout>

	<lightning-layout if:true={isShowResources} class="container__resource">
		<c-resource-component
			class="container__resource"
			resource-list={resourceList}
			selected-structure={selectedStructure}
			current-resource-activeted={currentResourceActiveted}
			activated-resource-index={activatedResourceIndex}
			onchooseresource={handleChooseResource}
			onchoosetyperesource={handleChooseTypeResource}
		>
		</c-resource-component>
	</lightning-layout>


		<lightning-layout if:true={isShowProducts} class="container__product" multiple-rows horizontal-align="space" style=" display: flex; flex-direction: row; justify-content: flex-start;">
			<lightning-layout-item size="12" medium-device-size="4" large-device-size="4" style=" display: flex; flex-direction: row; justify-content: center; align-items: stretch;">
				<c-selected-structure-component 
					selected-structure={selectedStructure}
					selected-resource-list={selectedResourceList}>
				</c-selected-structure-component>
			</lightning-layout-item>
			<lightning-layout-item class="slds-var-p-around_x-small" size="12" medium-device-size="8" large-device-size="8">
				<template for:each={products} for:item="product">
					<lightning-layout if:true={product.showSelectedStructure} key={product.id} class="container__product" multiple-rows horizontal-align="space">
						<lightning-layout-item class="slds-var-p-around_x-small" size="12" medium-device-size="12" large-device-size="12">
							<c-product-component
								product={product}
								enable-create-accessory
								onhandleproductdata={handleProductData}
								onhandleconfigkit={handleConfigureKit}
								onhandleclearconfigkit={handleClearKitConfiguration}
								onhandleselectproduct={handleSelectProduct}
								onhandleremoveproduct={handleRemoveProduct}
								onhandlechangeacessory={handleChangeAcessory}
								onhandleremovecheckoutacessory={handleRemoveCheckoutAcessory}
								onhandleremoveexception={handleremoveexception}
								onhandleeditexception={handleeditexception}
								onaddexceptionaccessory={onClickAddExceptionAccessoryEvent}
							>
							</c-product-component>
						</lightning-layout-item>
					</lightning-layout>
				</template>
			</lightning-layout-item>
		</lightning-layout>
	</div>
</template>